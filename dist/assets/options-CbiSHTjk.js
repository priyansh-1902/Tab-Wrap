import{c as G,j as t,r as m}from"./client-UQJF2hQD.js";import{c as C}from"./createLucideIcon-BQ3GTJNJ.js";/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],J=C("database",Y);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Q=C("pause",K);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Z=C("play",X);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],te=C("save",ee);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ae=C("user",oe),M=[{text:"Work",emoji:"ðŸ’¼",color:"#7e22ce"},{text:"Finance",emoji:"ðŸ’°",color:"#22c55e"},{text:"Hobbies",emoji:"ðŸŽ¨",color:"#facc15"},{text:"Spirituality",emoji:"ðŸ§˜",color:"#22d3ee"},{text:"Health",emoji:"ðŸ‹ï¸",color:"#ef4444"},{text:"Social Media",emoji:"ðŸ’¬",color:"#ff6347"},{text:"Community",emoji:"ðŸ¤",color:"#a259ff"},{text:"Entertainment",emoji:"ðŸŽ¬",color:"#fb923c"},{text:"Shopping",emoji:"ðŸ›’",color:"#38bdf8"},{text:"News",emoji:"ðŸ“°",color:"#2563eb"},{text:"Travel",emoji:"âœˆï¸",color:"#f472b6"},{text:"Miscellaneous",emoji:"â“",color:"#d1d5db"}],re=()=>t.jsx("div",{id:"notification-message",className:"fixed top-5 right-5 z-50 p-4 bg-purple-600/90 text-white rounded-lg shadow-xl transition-opacity duration-500 opacity-0 pointer-events-none",style:{minWidth:"200px",backdropFilter:"blur(5px)"},children:"Action Complete!"}),P=({onClick:I,children:D,className:v="",color:N="primary",Icon:T})=>{let b="py-3 px-6 rounded-xl font-bold text-base transition-all duration-300 shadow-lg flex items-center justify-center space-x-2 whitespace-nowrap",p="";switch(N){case"save":p="bg-gradient-to-r from-[#ff6347] to-[#e04020] text-white hover:from-[#e04020] hover:to-[#c03010] shadow-[#ff6347]/50";break;case"clear":p="bg-gray-800 text-gray-300 border border-gray-700 hover:bg-red-900/50 hover:text-white shadow-inner shadow-black/30";break;case"categorize":p="bg-gradient-to-r from-[#a855f7] to-[#8b5cf6] text-white hover:from-[#8b5cf6] hover:to-[#7c3aed] shadow-[#a855f7]/50";break;case"tabwrap":p="bg-gradient-to-r from-[#ff0099] to-[#d60080] text-white hover:from-[#e00080] hover:to-[#c20070] shadow-[#ff0099]/50";break;case"history-pause":p="bg-gray-800 text-red-400 border border-red-700/50 hover:bg-red-900/30 shadow-red-900/50";break;case"history-resume":p="bg-gray-800 text-green-400 border border-green-700/50 hover:bg-green-900/30 shadow-green-900/50";break;default:p="bg-gray-800 text-white hover:bg-gray-700"}return t.jsxs("button",{onClick:I,className:`${b} ${p} ${v}`,children:[T&&t.jsx(T,{className:"w-5 h-5"}),t.jsx("span",{children:D})]})};function se(){const[I,D]=m.useState({}),[v,N]=m.useState({description:"",categories:M}),[T,b]=m.useState(!1),[p,H]=m.useState([]),[ne,U]=m.useState(!1),[le,B]=m.useState(""),[k,$]=m.useState(!1),[V,W]=m.useState(!1),[L,A]=m.useState("");m.useEffect(()=>{chrome.storage.local.get(["db","profile","historyPaused","debugMode","debugDate","selectedCategories"],r=>{D(r.db||{});const a=r.profile||{description:"",categories:M};N(a),!a.description||a.description.trim()===""?(chrome.storage.local.set({historyPaused:!0}),b(!0)):b(!!r.historyPaused),U(!!r.debugMode),B(r.debugDate||""),H(r.selectedCategories||M.map(h=>typeof h=="string"?h:h.text))})},[]);const F=()=>{chrome.storage.local.set({profile:v},async()=>{const r=document.querySelector("textarea"),a=r?r.value:"";!a||a.trim()===""?(chrome.storage.local.set({historyPaused:!0}),b(!0)):(chrome.storage.local.set({historyPaused:!1}),b(!1)),await E(!0)})};async function z(r){return new Promise(a=>chrome.storage.local.get(r,a))}async function R(r){return new Promise(a=>chrome.storage.local.set(r,a))}async function q(){$(!0),W(!1),A("");const{db:r}=await z(["db"]);let a=0;for(const e of Object.keys(r||{}))for(const o of Object.values(r[e]||{}))a+=o.time||0;if(a<120){$(!1),W(!1),A("You have spent less than 5 minutes browsing. Maybe spend some time browsing and try again later.");return}await E(!1);const{profile:h}=await z(["db","profile"]),_=M.map(e=>typeof e=="string"?e:e.text.toLowerCase()),l={};for(const e of Object.keys(r||{}))for(const[o,i]of Object.entries(r[e]||{}))i.category&&_.includes(i.category.toLowerCase())&&(l[e]||(l[e]={}),l[e][o]={...i});const s={perDay:{},totalSeconds:0,totalMinutes:0,totalTabs:0,highestDay:null,highestMinutes:0,categoryTotals:{},categoryPercents:[],topCategoryWebsites:{}};let S=0,w=null,u=0;const y={};for(const e of Object.keys(l||{})){let o=0,i=0;for(const c of Object.values(l[e]||{}))o+=c.time||0,i+=c.count||0,c.category&&(y[c.category]||(y[c.category]=0),y[c.category]+=c.time||0);s.perDay[e]={seconds:o,minutes:Math.floor(o/60),tabs:i},a+=o,S+=i,o/60>u&&(u=Math.floor(o/60),w=e)}s.totalSeconds=a,s.totalMinutes=Math.floor(a/60),s.totalTabs=S,s.highestDay=w,s.highestMinutes=u,s.categoryTotals=y,s.categoryPercents=Object.entries(y).map(([e,o])=>({cat:e,sec:o,hrs:Math.round(o/3600),pct:a?o/a*100:0})).sort((e,o)=>o.sec-e.sec);const g=s.categoryPercents.filter(e=>e.sec>0).slice(0,5).map(e=>e.cat),f={};for(const e of g)f[e]=[];for(const e of Object.keys(l||{}))for(const[o,i]of Object.entries(l[e]||{}))g.includes(i.category)&&f[i.category].push({title:i.title||o,time:i.time||0,url:o});s.categorySummaries={};for(const e of g){f[e]=f[e].sort((o,i)=>i.time-o.time).slice(0,100),s.topCategoryWebsites[e]=f[e].map(o=>o.title),console.log("Top pages for category",e,":",s.topCategoryWebsites[e]);try{console.log("Summarizing category:",e);const o=await window.Summarizer.create({type:"tldr",format:"plain-text",length:"short",sharedContext:`Summarize the user's behavior in the category '${e}' from the following top 100 pages. Strictly keep it under 100 words.`}),i=f[e].map((d,n)=>`${n+1}. ${d.title} (${d.time} seconds)`).join(`
`),j=`User description: ${h?.description||""}
Top 100 pages in category '${e}':
${i}`,x=await o.summarize(j);s.categorySummaries[e]=x}catch(o){console.log("Error summarizing category",e,":",o),s.categorySummaries[e]="Summary unavailable."}}s.topCategoryStreaks={};for(const e of g){let o=[];const i={};for(const x of Object.keys(l||{})){let d=0;for(const n of Object.values(l[x]||{}))n.category===e&&(d+=n.time||0);i[x]=d}const c=Object.keys(i).sort();let j=[];if(c.length>0){const x=new Date(c[c.length-1]);for(let n=6;n>=0;n--){const O=new Date(x);O.setDate(O.getDate()-n),j.push(O.toISOString().slice(0,10))}o=j.map(n=>({date:n,minutes:i[n]||0})).map(n=>({date:n.date,seconds:n.minutes}))}else{const x=new Date;for(let d=6;d>=0;d--){const n=new Date(x);n.setDate(n.getDate()-d),j.push(n.toISOString().slice(0,10))}o=j.map(d=>({date:d,seconds:0}))}s.topCategoryStreaks[e]=o,console.log(`Streak for ${e}:`,o)}await R({tabWrapSummary:s}),$(!1),W(!0),console.log("Tab Wrap summary calculated!")}async function E(r=!1){const{db:a,profile:h}=await z(["db","profile"]);if(!window.LanguageModel){console.log("LanguageModel API not available");return}if(await LanguageModel.availability()==="unavailable"){console.log("Gemini Nano not available");return}const l=await LanguageModel.create(),s=h?.description||"",S=(h?.categories||[]).map(u=>typeof u=="string"?u:u.text);let w=!1;for(const u of Object.keys(a||{}))for(const[y,g]of Object.entries(a[u]||{}))if(r||!g.category){console.log("Checking entry for URL:",y,"Current category:",g.category);let f="";s.trim()!==""?f=`User description: ${s}
Categories: ${S.join(", ")}
URL: ${y}
Title: ${g.title}

Based on the above, which category was the user spending time on?
Strictly output **only** one category from the list above. Do not make up a new category that is not in the list provided.`:f=`
URL: ${y}
Title: ${g.title}

If the user was on the above webpage, which category out of ${S.join(", ")} were they likely spending time on?
 Strictly output **only** one category from the list above. Do not make up a new category that is not in the list provided.`,console.log("Asking model with prompt:",f);try{const e=await l.prompt(f);g.category=e.trim(),w=!0}catch{g.category="error",w=!0}}l.destroy(),w?await R({db:a}):console.log("No entries found.")}return t.jsxs("div",{className:"min-h-screen p-4 sm:p-8 flex flex-col items-center font-sans",style:{backgroundColor:"#0a0a0a"},children:[t.jsx(re,{}),t.jsxs("div",{className:"absolute inset-0 overflow-hidden -z-10",children:[t.jsx("div",{className:"absolute top-[-50px] left-[-50px] w-64 h-64 bg-green-500 rounded-full mix-blend-lighten filter blur-3xl opacity-10 animate-blob"}),t.jsx("div",{className:"absolute bottom-[-50px] right-[-50px] w-72 h-72 bg-purple-500 rounded-full mix-blend-lighten filter blur-3xl opacity-10 animate-blob animation-delay-2000"})]}),t.jsxs("div",{className:"relative z-10 w-full max-w-2xl p-6 sm:p-10 rounded-3xl bg-gray-900/70 backdrop-blur-md shadow-2xl shadow-black/80 space-y-8 mt-12 mb-12 border border-gray-800",children:[t.jsx("h1",{className:"text-4xl sm:text-5xl font-extrabold text-center uppercase tracking-wider mb-8",style:{color:"white",textShadow:"0 0 10px #ff0099, 0 0 20px #a855f7"},children:t.jsx("span",{className:"text-pink-400",children:"Tab Wrap"})}),t.jsx("hr",{className:"border-t border-gray-700/50"}),t.jsxs("div",{className:"space-y-3 pt-4",children:[t.jsxs("label",{className:"flex items-center text-xl font-bold text-white mb-2 tracking-wide",children:[t.jsx(ae,{className:"w-6 h-6 mr-3 text-pink-400"}),"Tell us about yourself:"]}),t.jsx("textarea",{value:v.description,onChange:r=>N({...v,description:r.target.value}),rows:"4",className:"w-full p-4 rounded-xl bg-gray-800 text-gray-200 border border-gray-700 focus:ring-2 focus:ring-[#ff0099] focus:border-[#ff0099] transition-colors resize-none shadow-inner shadow-black/20",placeholder:"For example, I am software developer who loves to read about technology, travel the world, and stay updated with the latest news."})]}),t.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:24,flexDirection:"column",alignItems:"center"},children:t.jsx(P,{onClick:F,color:"clear",className:"sm:col-span-1",Icon:te,children:"Save Profile"})}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 pt-4",children:[t.jsx(P,{onClick:()=>chrome.storage.local.set({db:{}},()=>D({})),color:"clear",className:"sm:col-span-1",Icon:J,children:"Clear History"}),T?t.jsx(P,{onClick:async()=>{const{profile:r}=await new Promise(a=>chrome.storage.local.get(["profile"],a));if(r&&r.description&&r.description.trim()!=="")chrome.storage.local.set({historyPaused:!1},()=>b(!1));else{const a=document.querySelector("textarea");a&&(a.style.boxShadow="0 0 0 3px #ff2d55",a.style.borderColor="#ff2d55",a.style.transition="box-shadow 0.3s, border-color 0.3s",setTimeout(()=>{a.style.boxShadow="",a.style.borderColor=""},2e3))}},color:"history-resume",className:"col-span-2",Icon:Z,children:"Resume History"}):t.jsx(P,{onClick:()=>chrome.storage.local.set({historyPaused:!0},()=>b(!0)),color:"history-pause",className:"col-span-2",Icon:Q,children:"Pause History"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"center",marginTop:24,flexDirection:"column",alignItems:"center"},children:[t.jsx("button",{style:{background:"white",color:"rgb(255, 90, 46)",border:"none",borderRadius:12,padding:"10px 32px",fontWeight:600,fontSize:18,boxShadow:"0 2px 8px rgba(255,45,85,0.18)",cursor:"pointer",marginBottom:k?16:0},onClick:q,disabled:k,children:"Tab Wrap"}),k&&t.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:40},children:[t.jsx("div",{className:"loader",style:{width:32,height:32,border:"4px solid #ff0099",borderTop:"4px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite"}}),t.jsx("style",{children:"@keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }"})]}),L&&!k&&t.jsx("div",{style:{color:"#ff0099",fontWeight:600,marginTop:12,textAlign:"center",maxWidth:320},children:L}),V&&!k&&t.jsx("button",{style:{background:"linear-gradient(90deg, #ff0099 0%, #232526 100%)",color:"#fff",border:"none",borderRadius:12,padding:"12px 32px",fontWeight:700,fontSize:18,boxShadow:"0 2px 8px rgba(255,45,85,0.18)",cursor:"pointer",marginTop:16},onClick:()=>window.location.href="../pages/tabwrap.html",children:"Take me to my Tab Wrap"})]}),t.jsx("hr",{className:"border-t border-gray-800"}),t.jsx("style",{children:`
          /* Define custom keyframes for the "cosmic blob" animation */
          @keyframes blob {
            0% {
              transform: translate(0px, 0px) scale(1);
            }
            33% {
              transform: translate(30px, -50px) scale(1.1);
            }
            66% {
              transform: translate(-20px, 20px) scale(0.9);
            }
            100% {
              transform: translate(0px, 0px) scale(1);
            }
          }
          .animate-blob {
            animation: blob 7s infinite cubic-bezier(0.6, -0.28, 0.735, 0.045);
          }
          .animation-delay-2000 {
            animation-delay: 2s;
          }
        `})]})]})}const ie=document.getElementById("root");G.createRoot(ie).render(t.jsx(se,{}));
